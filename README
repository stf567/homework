Учебный конфигурационный язык — CLI инструмент
Описание

Проект реализует инструмент командной строки для учебного конфигурационного языка.
Он позволяет:

Парсить конфигурацию с числами, строками, словарями и константами.

Подставлять значения констант на этапе трансформации.

Обнаруживать синтаксические ошибки и неопределённые константы.

Преобразовывать конфигурацию в формат TOML.

Работать как с stdin, так и с файлом конфигурации.

Синтаксис учебного конфигурационного языка
Константы
(define NAME value)


Поддерживаются числа, строки, словари.

Вычисляются на этапе трансформации:

size := [MAX_SIZE];

Словари
begin
    key1 := value1;
    key2 := value2;
end


Допускается вложенность словарей.

Разделение ; обязательно.

Числа и строки

Числа: [+-]?\d+

Строки: "текст"

Комментарии
Многострочные:

(comment
это комментарий
который можно игнорировать
)

Установка
git clone <репозиторий>
cd config_tool
pip install toml

Использование
Через файл:
Get-Content config.txt | python cli.py


или после обновления CLI (поддержка аргументов):

python cli.py config.txt

Интерактивно:
python cli.py
(define MAX 10)
begin
    value := [MAX];
end
<Ctrl-Z + Enter>  # завершение ввода в PowerShell

Примеры конфигураций и вывод в TOML
Веб-сервер

Конфигурация:

(define PORT 8080)
(define HOST "localhost")
begin
    server := begin
        host := [HOST];
        port := [PORT];
    end;
end


Вывод TOML:

[server]
host = "localhost"
port = 8080

Игра

Конфигурация:

(define MAX_PLAYERS 4)
begin
    game := begin
        level_size := 100;
        max_players := [MAX_PLAYERS];
        time_limit := 600;
    end;
end


Вывод TOML:

[game]
level_size = 100
max_players = 4
time_limit = 600

Тесты

Проект покрыт тестами с использованием pytest:

Тест	Описание	Ожидаемый результат
test_undefined_constant	Использование неопределённой константы	ValueError: Undefined constant: NAME
test_defined_constant	Определение и использование константы	Правильное подставление значения константы
test_nested_dict	Вложенные словари с константами	Правильная структура словаря и TOML
Запуск тестов
pytest tests/


Ожидаемый вывод:

============================= test session starts ==============================
collected 3 items

tests/test_config.py ...                                               [100%]

============================== 3 passed in 0.25s ==============================

Ошибки

Синтаксическая ошибка:

begin
    size := 42
end


Вывод:

Error: Unexpected token at line X


Неопределённая константа:

begin
    value := [UNDEFINED];
end


Вывод:

Error: Undefined constant: UNDEFINED
